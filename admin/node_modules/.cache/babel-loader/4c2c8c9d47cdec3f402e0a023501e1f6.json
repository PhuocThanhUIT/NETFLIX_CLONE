{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\H\\u1EE9aPh\\u01B0\\u1EDBcThanh\\\\Pictures\\\\NETFLIX_CLONE\\\\admin\\\\src\\\\pages\\\\movie\\\\Movie.jsx\",\n    _s = $RefreshSig$();\n\nimport { Link, useLocation } from \"react-router-dom\";\nimport { useContext, useState } from \"react\";\nimport storage from \"../../firebase\";\nimport \"./movie.css\";\nimport { Publish } from \"@material-ui/icons\";\nimport { getStorage, ref, uploadBytesResumable, getDownloadURL } from \"firebase/storage\";\nimport { updateMovie } from \"../../context/movieContext/apiCalls\";\nimport { MovieContext } from \"../../context/movieContext/MovieContext\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Movie() {\n  _s();\n\n  const location = useLocation();\n  const movies = location.movie;\n  const [movie, setMovie] = useState(null);\n  const [img, setImg] = useState(null);\n  const [trailer, setTrailer] = useState(null);\n  const [video, setVideo] = useState(null);\n  const [uploaded, setUploaded] = useState(0);\n  const {\n    dispatch\n  } = useContext(MovieContext);\n\n  const handleChange = e => {\n    const value = e.target.value;\n    setMovie({ ...movie,\n      [e.target.name]: value\n    });\n  };\n\n  const upload = items => {\n    items.forEach(item => {\n      const fileName = new Date().getTime() + item.label;\n      const storage = getStorage();\n      const storageRef = ref(storage, `/items/${fileName}`);\n      const uploadTask = uploadBytesResumable(storageRef, item.file); //const uploadTask = storage.storage().ref(`/items/${fileName}`).put(item.file);\n\n      uploadTask.on(\"state_changed\", snapshot => {\n        const progress = snapshot.bytesTransferred / snapshot.totalBytes * 100;\n        console.log(\"Upload is \" + progress + \"% done\");\n\n        switch (snapshot.state) {\n          case 'paused':\n            console.log('Upload is paused');\n            break;\n\n          case 'running':\n            console.log('Upload is running');\n            break;\n        }\n      }, error => {\n        switch (error.code) {\n          case 'storage/unauthorized':\n            // User doesn't have permission to access the object\n            break;\n\n          case 'storage/canceled':\n            // User canceled the upload\n            break;\n          // ...\n\n          case 'storage/unknown':\n            // Unknown error occurred, inspect error.serverResponse\n            break;\n        }\n      }, () => {\n        getDownloadURL(uploadTask.snapshot.ref).then(url => {\n          setMovie(prev => {\n            if ([item.label == \"\"]) {\n              return prev;\n            }\n\n            return { ...prev,\n              [item.label]: url\n            };\n          });\n          setUploaded(prev => prev + 1);\n        });\n      });\n    });\n  };\n\n  const handleUpload = e => {\n    e.preventDefault();\n    upload([{\n      file: img,\n      label: \"img\"\n    }, {\n      file: trailer,\n      label: \"trailer\"\n    }, {\n      file: video,\n      label: \"video\"\n    }]);\n  };\n\n  const handleSubmit = e => {\n    e.preventDefault();\n    updateMovie(movies._id, movie, dispatch);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"product\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"productTitleContainer\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"productTitle\",\n        children: \"Movie\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Link, {\n        to: \"/newproduct\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"productAddButton\",\n          children: \"Create\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"productTop\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"productTopRight\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"productInfoTop\",\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: movies.img,\n            alt: \"\",\n            className: \"productInfoImg\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"productName\",\n            children: movies.title\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 104,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"productInfoBottom\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"productInfoItem\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"productInfoKey\",\n              children: \"id:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 108,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"productInfoValue\",\n              children: movies._id\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 109,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"productInfoItem\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"productInfoKey\",\n              children: \"genre:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 112,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"productInfoValue\",\n              children: movies.genre\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 113,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 111,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"productInfoItem\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"productInfoKey\",\n              children: \"year:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 116,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"productInfoValue\",\n              children: movies.year\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 117,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 115,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"productInfoItem\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"productInfoKey\",\n              children: \"limit:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 120,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"productInfoValue\",\n              children: movies.limit\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 121,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 119,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"productBottom\",\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        className: \"productForm\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"productFormLeft\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Movie Title\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 129,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            name: \"title\",\n            placeholder: movies.title,\n            onChange: handleChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 130,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Year\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 131,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            name: \"year\",\n            placeholder: movies.year,\n            onChange: handleChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 132,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Genre\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 133,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            name: \"genre\",\n            placeholder: movies.genre,\n            onChange: handleChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 134,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Limit\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 135,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            name: \"limit\",\n            placeholder: movies.limit,\n            onChange: handleChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 136,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Trailer\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 137,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"file\",\n            name: \"trailer\",\n            placeholder: movies.trailer,\n            onChange: e => setTrailer(e.target.files[0])\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 138,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Video\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 139,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"file\",\n            name: \"video\",\n            placeholder: movies.video,\n            onChange: e => setVideo(e.target.files[0])\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 140,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Video\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 141,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"file\",\n            id: \"file\",\n            name: \"img\",\n            style: {\n              display: \"none\"\n            },\n            onChange: e => setImg(e.target.files[0])\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 142,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"productFormRight\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"productUpload\",\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              src: movies.img,\n              alt: \"\",\n              className: \"productUploadImg\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 146,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 145,\n            columnNumber: 13\n          }, this), uploaded === 3 ? /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"productButton\",\n            onClick: handleSubmit,\n            children: \"Update\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 155,\n            columnNumber: 11\n          }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"productButton\",\n            onClick: handleUpload,\n            children: \"Upload\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 159,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 93,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Movie, \"XgpM4NwaghQorabQxqE7IZHtfzY=\", false, function () {\n  return [useLocation];\n});\n\n_c = Movie;\n\nvar _c;\n\n$RefreshReg$(_c, \"Movie\");","map":{"version":3,"sources":["C:/Users/HứaPhướcThanh/Pictures/NETFLIX_CLONE/admin/src/pages/movie/Movie.jsx"],"names":["Link","useLocation","useContext","useState","storage","Publish","getStorage","ref","uploadBytesResumable","getDownloadURL","updateMovie","MovieContext","Movie","location","movies","movie","setMovie","img","setImg","trailer","setTrailer","video","setVideo","uploaded","setUploaded","dispatch","handleChange","e","value","target","name","upload","items","forEach","item","fileName","Date","getTime","label","storageRef","uploadTask","file","on","snapshot","progress","bytesTransferred","totalBytes","console","log","state","error","code","then","url","prev","handleUpload","preventDefault","handleSubmit","_id","title","genre","year","limit","files","display"],"mappings":";;;AAAA,SAASA,IAAT,EAAeC,WAAf,QAAkC,kBAAlC;AACA,SAASC,UAAT,EAAqBC,QAArB,QAAqC,OAArC;AACA,OAAOC,OAAP,MAAoB,gBAApB;AACA,OAAO,aAAP;AACA,SAASC,OAAT,QAAwB,oBAAxB;AACA,SAASC,UAAT,EAAqBC,GAArB,EAA0BC,oBAA1B,EAAgDC,cAAhD,QAAsE,kBAAtE;AACA,SAASC,WAAT,QAA4B,qCAA5B;AACA,SAASC,YAAT,QAA6B,yCAA7B;;AAEA,eAAe,SAASC,KAAT,GAAiB;AAAA;;AAC9B,QAAMC,QAAQ,GAAGZ,WAAW,EAA5B;AACA,QAAMa,MAAM,GAAGD,QAAQ,CAACE,KAAxB;AACA,QAAM,CAACA,KAAD,EAAQC,QAAR,IAAoBb,QAAQ,CAAC,IAAD,CAAlC;AACA,QAAM,CAACc,GAAD,EAAMC,MAAN,IAAgBf,QAAQ,CAAC,IAAD,CAA9B;AACA,QAAM,CAACgB,OAAD,EAAUC,UAAV,IAAwBjB,QAAQ,CAAC,IAAD,CAAtC;AACA,QAAM,CAACkB,KAAD,EAAQC,QAAR,IAAoBnB,QAAQ,CAAC,IAAD,CAAlC;AACA,QAAM,CAACoB,QAAD,EAAWC,WAAX,IAA0BrB,QAAQ,CAAC,CAAD,CAAxC;AAEA,QAAM;AAAEsB,IAAAA;AAAF,MAAevB,UAAU,CAACS,YAAD,CAA/B;;AAEA,QAAMe,YAAY,GAAIC,CAAD,IAAO;AAC1B,UAAMC,KAAK,GAAGD,CAAC,CAACE,MAAF,CAASD,KAAvB;AACAZ,IAAAA,QAAQ,CAAC,EAAE,GAAGD,KAAL;AAAY,OAACY,CAAC,CAACE,MAAF,CAASC,IAAV,GAAiBF;AAA7B,KAAD,CAAR;AACD,GAHD;;AAKA,QAAMG,MAAM,GAAIC,KAAD,IAAW;AACxBA,IAAAA,KAAK,CAACC,OAAN,CAAeC,IAAD,IAAU;AACtB,YAAMC,QAAQ,GAAG,IAAIC,IAAJ,GAAWC,OAAX,KAAuBH,IAAI,CAACI,KAA7C;AACA,YAAMlC,OAAO,GAAGE,UAAU,EAA1B;AACA,YAAMiC,UAAU,GAAGhC,GAAG,CAACH,OAAD,EAAW,UAAS+B,QAAS,EAA7B,CAAtB;AACA,YAAMK,UAAU,GAAGhC,oBAAoB,CAAC+B,UAAD,EAAaL,IAAI,CAACO,IAAlB,CAAvC,CAJsB,CAKtB;;AACAD,MAAAA,UAAU,CAACE,EAAX,CACE,eADF,EAEGC,QAAD,IAAc;AACZ,cAAMC,QAAQ,GACXD,QAAQ,CAACE,gBAAT,GAA4BF,QAAQ,CAACG,UAAtC,GAAoD,GADtD;AAEAC,QAAAA,OAAO,CAACC,GAAR,CAAY,eAAeJ,QAAf,GAA0B,QAAtC;;AACA,gBAAQD,QAAQ,CAACM,KAAjB;AACE,eAAK,QAAL;AACEF,YAAAA,OAAO,CAACC,GAAR,CAAY,kBAAZ;AACA;;AACF,eAAK,SAAL;AACED,YAAAA,OAAO,CAACC,GAAR,CAAY,mBAAZ;AACA;AANJ;AAQD,OAdH,EAeGE,KAAD,IAAW;AACT,gBAAQA,KAAK,CAACC,IAAd;AACE,eAAK,sBAAL;AACE;AACA;;AACF,eAAK,kBAAL;AACE;AACA;AAEF;;AAEA,eAAK,iBAAL;AACE;AACA;AAZJ;AAcD,OA9BH,EA+BE,MAAM;AACJ1C,QAAAA,cAAc,CAAC+B,UAAU,CAACG,QAAX,CAAoBpC,GAArB,CAAd,CAAwC6C,IAAxC,CAA8CC,GAAD,IAAS;AACpDrC,UAAAA,QAAQ,CAAEsC,IAAD,IAAU;AACjB,gBAAG,CAACpB,IAAI,CAACI,KAAL,IAAY,EAAb,CAAH,EAAoB;AAClB,qBAAOgB,IAAP;AACD;;AACD,mBAAO,EAAE,GAAGA,IAAL;AAAW,eAACpB,IAAI,CAACI,KAAN,GAAce;AAAzB,aAAP;AACD,WALO,CAAR;AAMA7B,UAAAA,WAAW,CAAE8B,IAAD,IAAUA,IAAI,GAAG,CAAlB,CAAX;AACD,SARD;AASD,OAzCH;AA2CD,KAjDD;AAkDD,GAnDD;;AAqDA,QAAMC,YAAY,GAAI5B,CAAD,IAAO;AAC1BA,IAAAA,CAAC,CAAC6B,cAAF;AACAzB,IAAAA,MAAM,CAAC,CACL;AAAEU,MAAAA,IAAI,EAAExB,GAAR;AAAaqB,MAAAA,KAAK,EAAE;AAApB,KADK,EAEL;AAAEG,MAAAA,IAAI,EAAEtB,OAAR;AAAiBmB,MAAAA,KAAK,EAAE;AAAxB,KAFK,EAGL;AAAEG,MAAAA,IAAI,EAAEpB,KAAR;AAAeiB,MAAAA,KAAK,EAAE;AAAtB,KAHK,CAAD,CAAN;AAKD,GAPD;;AASA,QAAMmB,YAAY,GAAI9B,CAAD,IAAO;AAC1BA,IAAAA,CAAC,CAAC6B,cAAF;AACA9C,IAAAA,WAAW,CAACI,MAAM,CAAC4C,GAAR,EAAY3C,KAAZ,EAAmBU,QAAnB,CAAX;AACD,GAHD;;AAIA,sBACE;AAAK,IAAA,SAAS,EAAC,SAAf;AAAA,4BACE;AAAK,MAAA,SAAS,EAAC,uBAAf;AAAA,8BACE;AAAI,QAAA,SAAS,EAAC,cAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADF,eAEE,QAAC,IAAD;AAAM,QAAA,EAAE,EAAC,aAAT;AAAA,+BACE;AAAQ,UAAA,SAAS,EAAC,kBAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,cAFF;AAAA;AAAA;AAAA;AAAA;AAAA,YADF,eAOE;AAAK,MAAA,SAAS,EAAC,YAAf;AAAA,6BACE;AAAK,QAAA,SAAS,EAAC,iBAAf;AAAA,gCACE;AAAK,UAAA,SAAS,EAAC,gBAAf;AAAA,kCACE;AAAK,YAAA,GAAG,EAAEX,MAAM,CAACG,GAAjB;AAAsB,YAAA,GAAG,EAAC,EAA1B;AAA6B,YAAA,SAAS,EAAC;AAAvC;AAAA;AAAA;AAAA;AAAA,kBADF,eAEE;AAAM,YAAA,SAAS,EAAC,aAAhB;AAAA,sBAA+BH,MAAM,CAAC6C;AAAtC;AAAA;AAAA;AAAA;AAAA,kBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,eAKE;AAAK,UAAA,SAAS,EAAC,mBAAf;AAAA,kCACE;AAAK,YAAA,SAAS,EAAC,iBAAf;AAAA,oCACE;AAAM,cAAA,SAAS,EAAC,gBAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADF,eAEE;AAAM,cAAA,SAAS,EAAC,kBAAhB;AAAA,wBAAoC7C,MAAM,CAAC4C;AAA3C;AAAA;AAAA;AAAA;AAAA,oBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAKE;AAAK,YAAA,SAAS,EAAC,iBAAf;AAAA,oCACE;AAAM,cAAA,SAAS,EAAC,gBAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADF,eAEE;AAAM,cAAA,SAAS,EAAC,kBAAhB;AAAA,wBAAoC5C,MAAM,CAAC8C;AAA3C;AAAA;AAAA;AAAA;AAAA,oBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,kBALF,eASE;AAAK,YAAA,SAAS,EAAC,iBAAf;AAAA,oCACE;AAAM,cAAA,SAAS,EAAC,gBAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADF,eAEE;AAAM,cAAA,SAAS,EAAC,kBAAhB;AAAA,wBAAoC9C,MAAM,CAAC+C;AAA3C;AAAA;AAAA;AAAA;AAAA,oBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,kBATF,eAaE;AAAK,YAAA,SAAS,EAAC,iBAAf;AAAA,oCACE;AAAM,cAAA,SAAS,EAAC,gBAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADF,eAEE;AAAM,cAAA,SAAS,EAAC,kBAAhB;AAAA,wBAAoC/C,MAAM,CAACgD;AAA3C;AAAA;AAAA;AAAA;AAAA,oBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,kBAbF;AAAA;AAAA;AAAA;AAAA;AAAA,gBALF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,YAPF,eAiCE;AAAK,MAAA,SAAS,EAAC,eAAf;AAAA,6BACE;AAAM,QAAA,SAAS,EAAC,aAAhB;AAAA,gCACE;AAAK,UAAA,SAAS,EAAC,iBAAf;AAAA,kCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eAEE;AAAO,YAAA,IAAI,EAAC,MAAZ;AAAmB,YAAA,IAAI,EAAC,OAAxB;AAAgC,YAAA,WAAW,EAAEhD,MAAM,CAAC6C,KAApD;AAA2D,YAAA,QAAQ,EAAEjC;AAArE;AAAA;AAAA;AAAA;AAAA,kBAFF,eAGE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAHF,eAIE;AAAO,YAAA,IAAI,EAAC,MAAZ;AAAmB,YAAA,IAAI,EAAC,MAAxB;AAAgC,YAAA,WAAW,EAAEZ,MAAM,CAAC+C,IAApD;AAA0D,YAAA,QAAQ,EAAEnC;AAApE;AAAA;AAAA;AAAA;AAAA,kBAJF,eAKE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBALF,eAME;AAAO,YAAA,IAAI,EAAC,MAAZ;AAAmB,YAAA,IAAI,EAAC,OAAxB;AAAgC,YAAA,WAAW,EAAEZ,MAAM,CAAC8C,KAApD;AAA2D,YAAA,QAAQ,EAAElC;AAArE;AAAA;AAAA;AAAA;AAAA,kBANF,eAOE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAPF,eAQE;AAAO,YAAA,IAAI,EAAC,MAAZ;AAAmB,YAAA,IAAI,EAAC,OAAxB;AAAgC,YAAA,WAAW,EAAEZ,MAAM,CAACgD,KAApD;AAA2D,YAAA,QAAQ,EAAEpC;AAArE;AAAA;AAAA;AAAA;AAAA,kBARF,eASE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBATF,eAUE;AAAO,YAAA,IAAI,EAAC,MAAZ;AAAmB,YAAA,IAAI,EAAC,SAAxB;AAAkC,YAAA,WAAW,EAAEZ,MAAM,CAACK,OAAtD;AAAgE,YAAA,QAAQ,EAAGQ,CAAD,IAAOP,UAAU,CAACO,CAAC,CAACE,MAAF,CAASkC,KAAT,CAAe,CAAf,CAAD;AAA3F;AAAA;AAAA;AAAA;AAAA,kBAVF,eAWE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAXF,eAYE;AAAO,YAAA,IAAI,EAAC,MAAZ;AAAmB,YAAA,IAAI,EAAC,OAAxB;AAAgC,YAAA,WAAW,EAAEjD,MAAM,CAACO,KAApD;AAA2D,YAAA,QAAQ,EAAGM,CAAD,IAAOL,QAAQ,CAACK,CAAC,CAACE,MAAF,CAASkC,KAAT,CAAe,CAAf,CAAD;AAApF;AAAA;AAAA;AAAA;AAAA,kBAZF,eAaE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAbF,eAcE;AAAO,YAAA,IAAI,EAAC,MAAZ;AAAmB,YAAA,EAAE,EAAC,MAAtB;AAA6B,YAAA,IAAI,EAAC,KAAlC;AAAwC,YAAA,KAAK,EAAE;AAAEC,cAAAA,OAAO,EAAE;AAAX,aAA/C;AAAoE,YAAA,QAAQ,EAAGrC,CAAD,IAAOT,MAAM,CAACS,CAAC,CAACE,MAAF,CAASkC,KAAT,CAAe,CAAf,CAAD;AAA3F;AAAA;AAAA;AAAA;AAAA,kBAdF;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,eAiBE;AAAK,UAAA,SAAS,EAAC,kBAAf;AAAA,kCACE;AAAK,YAAA,SAAS,EAAC,eAAf;AAAA,mCACE;AACE,cAAA,GAAG,EAAEjD,MAAM,CAACG,GADd;AAEE,cAAA,GAAG,EAAC,EAFN;AAGE,cAAA,SAAS,EAAC;AAHZ;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,kBADF,EAUGM,QAAQ,KAAK,CAAb,gBACH;AAAQ,YAAA,SAAS,EAAC,eAAlB;AAAkC,YAAA,OAAO,EAAEkC,YAA3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADG,gBAKH;AAAQ,YAAA,SAAS,EAAC,eAAlB;AAAkC,YAAA,OAAO,EAAEF,YAA3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAfA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAjBF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,YAjCF;AAAA;AAAA;AAAA;AAAA;AAAA,UADF;AA4ED;;GA9JuB3C,K;UACLX,W;;;KADKW,K","sourcesContent":["import { Link, useLocation } from \"react-router-dom\";\r\nimport { useContext, useState } from \"react\";\r\nimport storage from \"../../firebase\";\r\nimport \"./movie.css\";\r\nimport { Publish } from \"@material-ui/icons\";\r\nimport { getStorage, ref, uploadBytesResumable, getDownloadURL } from \"firebase/storage\";\r\nimport { updateMovie } from \"../../context/movieContext/apiCalls\";\r\nimport { MovieContext } from \"../../context/movieContext/MovieContext\";\r\n\r\nexport default function Movie() {\r\n  const location = useLocation();\r\n  const movies = location.movie;\r\n  const [movie, setMovie] = useState(null);\r\n  const [img, setImg] = useState(null);\r\n  const [trailer, setTrailer] = useState(null);\r\n  const [video, setVideo] = useState(null);\r\n  const [uploaded, setUploaded] = useState(0);\r\n\r\n  const { dispatch } = useContext(MovieContext);\r\n\r\n  const handleChange = (e) => {\r\n    const value = e.target.value;\r\n    setMovie({ ...movie, [e.target.name]: value });\r\n  };\r\n\r\n  const upload = (items) => {\r\n    items.forEach((item) => {\r\n      const fileName = new Date().getTime() + item.label;\r\n      const storage = getStorage();\r\n      const storageRef = ref(storage, `/items/${fileName}`);\r\n      const uploadTask = uploadBytesResumable(storageRef, item.file);\r\n      //const uploadTask = storage.storage().ref(`/items/${fileName}`).put(item.file);\r\n      uploadTask.on(\r\n        \"state_changed\",\r\n        (snapshot) => {\r\n          const progress =\r\n            (snapshot.bytesTransferred / snapshot.totalBytes) * 100;\r\n          console.log(\"Upload is \" + progress + \"% done\");\r\n          switch (snapshot.state) {\r\n            case 'paused':\r\n              console.log('Upload is paused');\r\n              break;\r\n            case 'running':\r\n              console.log('Upload is running');\r\n              break;\r\n          } \r\n        },\r\n        (error) => {\r\n          switch (error.code) {\r\n            case 'storage/unauthorized':\r\n              // User doesn't have permission to access the object\r\n              break;\r\n            case 'storage/canceled':\r\n              // User canceled the upload\r\n              break;\r\n      \r\n            // ...\r\n      \r\n            case 'storage/unknown':\r\n              // Unknown error occurred, inspect error.serverResponse\r\n              break;\r\n          }\r\n        },\r\n        () => {\r\n          getDownloadURL(uploadTask.snapshot.ref).then((url) => {\r\n            setMovie((prev) => {\r\n              if([item.label==\"\"]){\r\n                return prev;\r\n              }\r\n              return { ...prev, [item.label]: url };\r\n            });\r\n            setUploaded((prev) => prev + 1);\r\n          });\r\n        }\r\n      );\r\n    });\r\n  };\r\n\r\n  const handleUpload = (e) => {\r\n    e.preventDefault();\r\n    upload([\r\n      { file: img, label: \"img\" },\r\n      { file: trailer, label: \"trailer\" },\r\n      { file: video, label: \"video\" },\r\n    ]);\r\n  };\r\n\r\n  const handleSubmit = (e) => {\r\n    e.preventDefault();\r\n    updateMovie(movies._id,movie, dispatch);\r\n  };\r\n  return (\r\n    <div className=\"product\">\r\n      <div className=\"productTitleContainer\">\r\n        <h1 className=\"productTitle\">Movie</h1>\r\n        <Link to=\"/newproduct\">\r\n          <button className=\"productAddButton\">Create</button>\r\n        </Link>\r\n      </div>\r\n      <div className=\"productTop\">\r\n        <div className=\"productTopRight\">\r\n          <div className=\"productInfoTop\">\r\n            <img src={movies.img} alt=\"\" className=\"productInfoImg\" />\r\n            <span className=\"productName\">{movies.title}</span>\r\n          </div>\r\n          <div className=\"productInfoBottom\">\r\n            <div className=\"productInfoItem\">\r\n              <span className=\"productInfoKey\">id:</span>\r\n              <span className=\"productInfoValue\">{movies._id}</span>\r\n            </div>\r\n            <div className=\"productInfoItem\">\r\n              <span className=\"productInfoKey\">genre:</span>\r\n              <span className=\"productInfoValue\">{movies.genre}</span>\r\n            </div>\r\n            <div className=\"productInfoItem\">\r\n              <span className=\"productInfoKey\">year:</span>\r\n              <span className=\"productInfoValue\">{movies.year}</span>\r\n            </div>\r\n            <div className=\"productInfoItem\">\r\n              <span className=\"productInfoKey\">limit:</span>\r\n              <span className=\"productInfoValue\">{movies.limit}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div className=\"productBottom\">\r\n        <form className=\"productForm\">\r\n          <div className=\"productFormLeft\">\r\n            <label>Movie Title</label>\r\n            <input type=\"text\" name=\"title\" placeholder={movies.title} onChange={handleChange}/>\r\n            <label>Year</label>\r\n            <input type=\"text\" name=\"year\"  placeholder={movies.year} onChange={handleChange}/>\r\n            <label>Genre</label>\r\n            <input type=\"text\" name=\"genre\" placeholder={movies.genre} onChange={handleChange}/>\r\n            <label>Limit</label>\r\n            <input type=\"text\" name=\"limit\" placeholder={movies.limit} onChange={handleChange}/>\r\n            <label>Trailer</label>\r\n            <input type=\"file\" name=\"trailer\" placeholder={movies.trailer}  onChange={(e) => setTrailer(e.target.files[0])}/>\r\n            <label>Video</label>\r\n            <input type=\"file\" name=\"video\" placeholder={movies.video} onChange={(e) => setVideo(e.target.files[0])}/>\r\n            <label>Video</label>\r\n            <input type=\"file\" id=\"file\" name=\"img\" style={{ display: \"none\" }} onChange={(e) => setImg(e.target.files[0])}/>\r\n          </div>\r\n          <div className=\"productFormRight\">\r\n            <div className=\"productUpload\">\r\n              <img\r\n                src={movies.img}\r\n                alt=\"\"\r\n                className=\"productUploadImg\"\r\n              />\r\n\r\n              \r\n            </div>\r\n            {uploaded === 3 ? (\r\n          <button className=\"productButton\" onClick={handleSubmit}>\r\n            Update\r\n          </button>\r\n        ) : (\r\n          <button className=\"productButton\" onClick={handleUpload}>\r\n            Upload\r\n          </button>\r\n        )}\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n}"]},"metadata":{},"sourceType":"module"}